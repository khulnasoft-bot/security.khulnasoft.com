import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card"
import { Badge } from "@/components/ui/badge"
import { WormIcon as Virus, AlertTriangle, Search, Package, ExternalLink } from "lucide-react"
import Link from "next/link"
import { Input } from "@/components/ui/input"
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs"
import { Button } from "@/components/ui/button"

export default function MalwarePage() {
  // Sample malware entries
  const malwareEntries = [
    {
      id: "mal-2023-001",
      name: "Emotet",
      type: "Banking Trojan",
      severity: "Critical",
      firstSeen: "2014-06-01",
      lastSeen: "2023-04-15",
      description:
        "Emotet is a banking Trojan that primarily spreads through spam emails. It has evolved to become a distribution platform for other malware.",
    },
    {
      id: "mal-2023-002",
      name: "Conti Ransomware",
      type: "Ransomware",
      severity: "Critical",
      firstSeen: "2020-02-01",
      lastSeen: "2023-05-01",
      description:
        "Conti is a Ransomware-as-a-Service (RaaS) operation that targets organizations to encrypt their data and demand a ransom payment.",
    },
    {
      id: "mal-2023-003",
      name: "Trickbot",
      type: "Banking Trojan",
      severity: "High",
      firstSeen: "2016-10-01",
      lastSeen: "2023-03-20",
      description:
        "Trickbot is a modular banking Trojan that targets sensitive information and acts as a dropper for other malware, including ransomware.",
    },
    {
      id: "mal-2023-004",
      name: "Qakbot",
      type: "Banking Trojan",
      severity: "High",
      firstSeen: "2008-01-01",
      lastSeen: "2023-05-10",
      description:
        "Qakbot (also known as QBot) is a banking Trojan that steals banking credentials and provides remote access to infected systems.",
    },
    {
      id: "mal-2023-005",
      name: "LockBit Ransomware",
      type: "Ransomware",
      severity: "Critical",
      firstSeen: "2019-09-01",
      lastSeen: "2023-05-12",
      description:
        "LockBit is a ransomware operation that uses a double extortion model, encrypting data and threatening to publish stolen information.",
    },
    {
      id: "mal-2023-006",
      name: "Cobalt Strike Beacon",
      type: "Remote Access Trojan",
      severity: "Critical",
      firstSeen: "2012-01-01",
      lastSeen: "2023-05-15",
      description:
        "Cobalt Strike is a legitimate penetration testing tool that is frequently abused by threat actors for command and control operations.",
    },
  ]

  // Sample malicious packages from khulnasoft-lab/malicious-packages
  const maliciousPackages = [
    {
      id: "pkg-2023-001",
      name: "color-rgba",
      ecosystem: "npm",
      discoveredDate: "2023-02-10",
      maliciousActivity: "Data exfiltration",
      description:
        "A malicious package that steals environment variables and sends them to an attacker-controlled server.",
    },
    {
      id: "pkg-2023-002",
      name: "ctx",
      ecosystem: "PyPI",
      discoveredDate: "2022-05-24",
      maliciousActivity: "Credential theft",
      description:
        "A hijacked legitimate package that was modified to steal AWS credentials and environment variables.",
    },
    {
      id: "pkg-2023-003",
      name: "event-source",
      ecosystem: "npm",
      discoveredDate: "2022-11-15",
      maliciousActivity: "Cryptomining",
      description:
        "A malicious package that installs a cryptominer on the victim's system, consuming resources for cryptocurrency mining.",
    },
    {
      id: "pkg-2023-004",
      name: "request-modules",
      ecosystem: "npm",
      discoveredDate: "2023-01-05",
      maliciousActivity: "Supply chain attack",
      description:
        "A typosquatting package that mimics a popular library but contains malicious code to compromise the build pipeline.",
    },
    {
      id: "pkg-2023-005",
      name: "python3-dateutil",
      ecosystem: "PyPI",
      discoveredDate: "2022-08-02",
      maliciousActivity: "Backdoor",
      description: "A typosquatting package that installs a backdoor allowing remote access to the compromised system.",
    },
    {
      id: "pkg-2023-006",
      name: "discord-lofy",
      ecosystem: "npm",
      discoveredDate: "2023-03-18",
      maliciousActivity: "Data exfiltration",
      description:
        "A malicious package that steals Discord tokens and browser data, sending them to an attacker-controlled server.",
    },
  ]

  const getSeverityClass = (severity: string) => {
    switch (severity) {
      case "Critical":
        return "bg-red-500/20 text-red-500 border-red-500/30"
      case "High":
        return "bg-amber-500/20 text-amber-500 border-amber-500/30"
      case "Medium":
        return "bg-yellow-500/20 text-yellow-500 border-yellow-500/30"
      case "Low":
        return "bg-green-500/20 text-green-500 border-green-500/30"
      default:
        return "bg-primary/10 text-primary border-primary/30"
    }
  }

  const getEcosystemClass = (ecosystem: string) => {
    switch (ecosystem) {
      case "npm":
        return "bg-red-500/20 text-red-500 border-red-500/30"
      case "PyPI":
        return "bg-blue-500/20 text-blue-500 border-blue-500/30"
      case "RubyGems":
        return "bg-red-700/20 text-red-700 border-red-700/30"
      case "Maven":
        return "bg-orange-500/20 text-orange-500 border-orange-500/30"
      case "Go":
        return "bg-cyan-500/20 text-cyan-500 border-cyan-500/30"
      default:
        return "bg-primary/10 text-primary border-primary/30"
    }
  }

  return (
    <div className="container py-8">
      <div className="flex flex-col gap-8">
        <div>
          <h1 className="text-3xl font-bold mb-2 flex items-center gap-2">
            <Virus className="h-6 w-6 text-primary" />
            Malware Database
          </h1>
          <p className="text-muted-foreground max-w-3xl">
            A comprehensive database of known malware and malicious packages, including details on behavior, indicators
            of compromise, and mitigation strategies.
          </p>
        </div>

        <div className="relative">
          <Search className="absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground" />
          <Input
            type="search"
            placeholder="Search malware by name, type, or ID..."
            className="pl-9 bg-background/60 backdrop-blur-sm border-primary/20 search-glow"
          />
        </div>

        <Tabs defaultValue="malware">
          <TabsList className="mb-4 bg-muted/50">
            <TabsTrigger value="malware">Malware</TabsTrigger>
            <TabsTrigger value="packages">Malicious Packages</TabsTrigger>
          </TabsList>

          <TabsContent value="malware" className="space-y-6">
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {malwareEntries.map((malware) => (
                <Link key={malware.id} href={`/malware/${malware.id}`}>
                  <Card className="bg-background/40 backdrop-blur-sm border-primary/20 card-hover h-full">
                    <CardHeader className="pb-2">
                      <div className="flex items-center justify-between mb-2">
                        <Badge variant="outline" className={getSeverityClass(malware.severity)}>
                          {malware.severity}
                        </Badge>
                        <Badge variant="outline" className="bg-primary/10 text-primary border-primary/30">
                          {malware.type}
                        </Badge>
                      </div>
                      <div className="flex items-center gap-2">
                        <AlertTriangle className="h-4 w-4 text-amber-500" />
                        <CardTitle className="text-lg">{malware.name}</CardTitle>
                      </div>
                      <CardDescription className="text-xs text-muted-foreground">
                        ID: {malware.id} | First seen: {malware.firstSeen} | Last seen: {malware.lastSeen}
                      </CardDescription>
                    </CardHeader>
                    <CardContent>
                      <p className="text-sm text-muted-foreground">{malware.description}</p>
                    </CardContent>
                  </Card>
                </Link>
              ))}
            </div>
          </TabsContent>

          <TabsContent value="packages" className="space-y-6">
            <div className="flex items-center justify-between mb-4">
              <h2 className="text-xl font-bold">Malicious Packages</h2>
              <Button variant="outline" className="flex items-center gap-2" asChild>
                <a
                  href="https://github.com/khulnasoft-lab/malicious-packages"
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  View Repository <ExternalLink className="h-4 w-4" />
                </a>
              </Button>
            </div>
            <p className="text-muted-foreground mb-4">
              This collection of malicious packages is sourced from the{" "}
              <a
                href="https://github.com/khulnasoft-lab/malicious-packages"
                target="_blank"
                rel="noopener noreferrer"
                className="text-primary hover:underline"
              >
                khulnasoft-lab/malicious-packages
              </a>{" "}
              repository, which provides reports and analysis of malicious packages found in various package ecosystems.
            </p>

            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {maliciousPackages.map((pkg) => (
                <Link key={pkg.id} href={`/malware/packages/${pkg.id}`}>
                  <Card className="bg-background/40 backdrop-blur-sm border-primary/20 card-hover h-full">
                    <CardHeader className="pb-2">
                      <div className="flex items-center justify-between mb-2">
                        <Badge variant="outline" className={getEcosystemClass(pkg.ecosystem)}>
                          {pkg.ecosystem}
                        </Badge>
                        <Badge variant="outline" className="bg-primary/10 text-primary border-primary/30">
                          {pkg.maliciousActivity}
                        </Badge>
                      </div>
                      <div className="flex items-center gap-2">
                        <Package className="h-4 w-4 text-red-500" />
                        <CardTitle className="text-lg">{pkg.name}</CardTitle>
                      </div>
                      <CardDescription className="text-xs text-muted-foreground">
                        ID: {pkg.id} | Discovered: {pkg.discoveredDate}
                      </CardDescription>
                    </CardHeader>
                    <CardContent>
                      <p className="text-sm text-muted-foreground">{pkg.description}</p>
                    </CardContent>
                  </Card>
                </Link>
              ))}
            </div>

            <div className="flex justify-center mt-6">
              <Button asChild>
                <Link href="/malware/packages">View All Malicious Packages</Link>
              </Button>
            </div>
          </TabsContent>
        </Tabs>
      </div>
    </div>
  )
}
